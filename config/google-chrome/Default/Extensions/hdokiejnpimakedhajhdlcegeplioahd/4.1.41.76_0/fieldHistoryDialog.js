var FieldHistoryDialog=function(k){Dialog.call(this,k,{backButtonText:Strings.translateString("Hide All"),nextButtonText:Strings.translateString("Show All"),closeButtonEnabled:!0,dynamicHeight:!0,confirmOnClose:!1,overlayDialog:!0});this.toggles=null};FieldHistoryDialog.prototype=Object.create(Dialog.prototype);FieldHistoryDialog.prototype.constructor=FieldHistoryDialog;
(function(k){var n=function(b,a,c){this.show=function(){c.value=LPProxy.decrypt(b,a.getKey())};this.getElement=function(){return e};var e=LPTools.createElement("div","action",Strings.translateString("Show"));$(e).bind("click",function(a){return function(){a.show()}}(this))},p=function(b,a){var c=!1;this.show=function(){f.value=LPProxy.decrypt(b,a.getKey());g.addClass("selected");c=!0};this.hide=function(){f.value=l;g.removeClass("selected");c=!1};this.toggle=function(){c?this.hide():this.show()};
this.getElement=function(){return e};var e=LPTools.createElement("div","relative"),f=LPTools.createElement("input",{"class":"dialogInput",readonly:!0,type:"text"});f.value=l;e.appendChild(f);var g=LPTools.createElement("div","showPassword iconButton");e.appendChild(g);g=$(g);g.bind("click",function(a){return function(){a.toggle()}}(this))},l="********************";FieldHistoryDialog.prototype.open=function(b){this.toggles=[];b=b||{};b.title=Strings.translateString("Password History");b.type===Constants.HISTORY_TYPES.USERNAME?
b.title=Strings.translateString("Username History"):b.type===Constants.HISTORY_TYPES.NOTE&&(b.title=Strings.translateString("Note History"));Dialog.prototype.open.call(this,b)};FieldHistoryDialog.prototype.initialize=function(){Dialog.prototype.initialize.apply(this,arguments);this.backButton.unbind("click");this.nextButton.unbind("click");(function(b){b.backButton.bind("click",function(){for(var a=0,c=b.toggles.length;a<c;++a)b.toggles[a].hide()});b.nextButton.bind("click",function(){for(var a=0,
c=b.toggles.length;a<c;++a)b.toggles[a].show()})})(this)};FieldHistoryDialog.prototype.close=function(){Dialog.prototype.close.apply(this,arguments);k.getElementById("fieldHistoryNoteDisplay").value="";$("#fieldHistoryElements").empty()};FieldHistoryDialog.prototype.setup=function(b,a){var c=Strings.translateString("Password");a.type===Constants.HISTORY_TYPES.USERNAME?c=Strings.translateString("Usernameproper"):a.type===Constants.HISTORY_TYPES.NOTE&&(c=Strings.translateString("Action"));var e=k.getElementById("fieldHistoryNoteDisplay");
$("#fieldHistoryColumnHeader").text(c);c=document.getElementById("fieldHistoryElements");if(a.history&&0<a.history.length){this.$element.removeClass("empty");for(var f=0,g=a.history.length;f<g;++f){var d=a.history[f],m=LPTools.createElement("tr");c.appendChild(m);var h=LPTools.createElement("td","fieldHistoryDate",d.date),l=d.whom&&d.whom.length?Strings.translateString("by")+" "+d.whom:"";h.appendChild(LPTools.createElement("p","fieldHistoryWhom",l));m.appendChild(h);d=a.type===Constants.HISTORY_TYPES.NOTE?
new n(d.value,a.vaultItem,e):new p(d.value,a.vaultItem);h=LPTools.createElement("td");h.appendChild(d.getElement());m.appendChild(h);this.toggles.push(d)}}else this.$element.addClass("empty");Dialog.prototype.setup.apply(this,arguments);a.history&&0<a.history.length&&a.type===Constants.HISTORY_TYPES.NOTE?(this.$element.addClass("noteHistory"),this.dialogContent.css("bottom","0")):this.$element.removeClass("noteHistory")}})(document);
