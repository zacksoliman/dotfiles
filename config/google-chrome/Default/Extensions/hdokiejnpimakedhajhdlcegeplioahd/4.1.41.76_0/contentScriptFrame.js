LPFrame=function(){var r=0,f={},e=null,h=function(){var b=function(b){return"string"===typeof b?b:"number"===typeof b?b+"px":""};return function(c,a){for(var d in a)c.style.setProperty(d,b(a[d]),"important");return c}}(),t=function(b){var c=++r,a=b.tracking,d=null,e=new LPEventManager,n=[],p=null,q=null,m=b.interfaceDefinition;f[c]=this;var g=function(){var k=document.createElement("iframe"),a=getchromeurl(b.url),a=a+((-1<a.indexOf("?")?"&":"?")+"dialogID="+c);g_isfirefoxsdk?k.setAttribute("lpsrc",
a):k.src=a;h(k,{border:"none",position:"relative",height:"100%",width:"100%",visibility:"visible"});k.setAttribute("scrolling","no");a=document.createElement("div");h(a,{position:"fixed","z-index":"2147483647",display:"none",width:"100%",height:"100%"});a.appendChild(k);document.body.appendChild(a);return a}();this.close=function(){e.publishEvent("close");g.parentElement.removeChild(g);window.removeEventListener("resize",this.refreshPosition);window.removeEventListener("scroll",this.refreshPosition);
delete f[c]};this.onClose=function(a){e.addEventListener("close",a)};this.css=function(a){h(g,a);this.refreshPosition()};var l=function(a,b,c){if(c){if("string"===typeof c)if(c.indexOf("%"))c=a[b]*parseInt(c.substring(0,c.indexOf("%")))/100;else throw"trackElement only supports numbers or percentages for translations";return c}return 0};this.refreshPosition=function(){if(a){var b=a.element.getBoundingClientRect(),c=b.top,b=b.left;a.frameTranslation&&(c+=l(g,"clientHeight",a.frameTranslation.y),b+=
l(g,"clientWidth",a.frameTranslation.x));a.targetTranslation&&(c+=l(a.element,"clientHeight",a.targetTranslation.y),b+=l(a.element,"clientWidth",a.targetTranslation.x));h(g,{top:c,left:b})}};this.trackElement=function(b){a=b;window.addEventListener("resize",this.refreshPosition);window.addEventListener("scroll",this.refreshPosition)};this.getInterface=function(){null===q&&(p=function(a){null===d?n.push(a):LPPlatform.requestFramework.sendRequest({type:"contentScriptRequest",data:a,frameID:d})},q=Interfaces.createInstance(m,
{direct:!1,context:"contentScript",requestFunction:p}));return q};this.setFrameID=function(a){d=a;for(a=0;a<n.length;++a)p(n[a])};this.getDialogID=function(){return c};a&&this.trackElement(a)};Topics.get(Topics.CLEAR_DATA).subscribe(function(){for(var b in f)f[b].close()});var m=function(b){return new t(b)};return{css:function(b){if(b){var c=f[b.id];c&&c.css(b.css)}"function"===typeof b.callback&&b.callback()},close:function(b){(b=f[b])&&b.close()},openDialog:function(b,c,a){var d=m({url:"contentScriptDialog.html",
interfaceDefinition:Interfaces.ContentScriptDialogInterface});d.getInterface().LPDialog.openDialog(b,c);a&&(a.css&&d.css(a.css),a.callback&&a.callback(d.getDialogID()));return d},openFrame:m,initializeRequestFramework:function(b,c){var a=f[b];a&&a.setFrameID(c)},showModal:function(b){null===e&&(e=document.createElement("div"),h(e,{position:"fixed","z-index":"2147483646",top:"0px",right:"0px",bottom:"0px",left:"0px","background-color":"rgba(52, 61, 68, 0.6)"}));document.body.appendChild(e)},hideModal:function(){e&&
document.body.removeChild(e)}}}();
