var omsNotification=function(){function m(){LPPlatform.onTabActivated(function(a){c.opened&&(d(),c.tabInterface=a,g(a))});LPPlatform.onTabUpdated(function(a){c.opened&&a.tabDetails.tabID===c.tabInterface.tabDetails.tabID&&(c.opened=!1,c.tabInterface=a,g(a))})}function g(a){var b=OmsNotificationPopup.getState();if(lploggedin&&!isOffline()&&g_onemin_advert_enabled&&!(n()>g_onemin_advert_app_threshold)&&!c.opened&&b!==oneMinuteSignup.FeatureState.started&&b!==oneMinuteSignup.FeatureState.cancel){if(b===
oneMinuteSignup.FeatureState.postpone||b===oneMinuteSignup.FeatureState.postponeNextDay){var d=parseInt(localStorage_getItem(db_prepend("oms_postponed_date"))),e=parseInt(localStorage_getItem(db_prepend("oms_postponed_threshold_days"))),e=isNaN(e)?7:e;b===oneMinuteSignup.FeatureState.postponeNextDay&&(e=1);b=864E5*e;if(Date.now()-d<b)return}k||(f=Date.now(),k=!0,sendLpImprove("oneminute::notificationshown",{textVersion:_textVersion}));a.getTop().LPFrame.openDialog("omsNotificationPopup",{provider:l(),
textVersion:_textVersion},{css:{top:0,right:0},callback:function(a){c.dialogId=a}});c.opened=!0;c.tabInterface=a}}function h(a){switch(a){case oneMinuteSignup.FeatureState.started:localStorage_setItem(db_prepend("oms_state"),oneMinuteSignup.FeatureState.started);break;case oneMinuteSignup.FeatureState.cancel:localStorage_setItem(db_prepend("oms_state"),oneMinuteSignup.FeatureState.cancel);break;case oneMinuteSignup.FeatureState.postpone:localStorage_setItem(db_prepend("oms_state"),oneMinuteSignup.FeatureState.postpone);
break;case oneMinuteSignup.FeatureState.postponeNextDay:localStorage_setItem(db_prepend("oms_state"),oneMinuteSignup.FeatureState.postponeNextDay)}}function n(){var a=0,b;for(b in g_sites)g_sites.hasOwnProperty(b)&&a++;return a}function l(){if(g_username){if(-1!==g_username.indexOf("@gmail"))return"Gmail";if(-1!==g_username.indexOf("@yahoo"))return"Yahoo";if(-1!==g_username.indexOf("@outlook"))return"Office365"}return"Unknown"}function d(){c.opened=!1;var a=c.dialogId;a&&c.tabInterface&&LPTabs.get({tabID:c.tabInterface.tabDetails.tabID,
callback:function(b){(b=b.getTop())&&b.LPFrame.close(a)}})}var c={opened:!1,tabInterface:null,dialogId:-1},k=!1,f;(function(){_textVersion=Math.ceil(2*Math.random());m();setInterval(function(){LPPlatform.getCurrentTab(function(a){g(a)})},1E4)})();return{startOms:function(){var a=(Date.now()-f)/1E3;d();openvault(!1,"omsstart",function(b){sendLpImprove("oneminute::notificationomsstart",{provider:l(),elapsedTimeInSec:a.toFixed(),textVersion:_textVersion})})},cancelNotification:function(){var a=(Date.now()-
f)/1E3;h(oneMinuteSignup.FeatureState.cancel);d();sendLpImprove("oneminute::notificationclose",{elapsedTimeInSec:a.toFixed(),textVersion:_textVersion})},postponeNotification:function(a){var b=(Date.now()-f)/1E3;h(a?oneMinuteSignup.FeatureState.postponeNextDay:oneMinuteSignup.FeatureState.postpone);d();localStorage_setItem(db_prepend("oms_postponed_date"),Date.now());a||sendLpImprove("oneminute::notificationnotnowclicked",{elapsedTimeInSec:b.toFixed(),textVersion:_textVersion})},setState:h,getState:function(){return localStorage_getItem(db_prepend("oms_state"))}}}();
