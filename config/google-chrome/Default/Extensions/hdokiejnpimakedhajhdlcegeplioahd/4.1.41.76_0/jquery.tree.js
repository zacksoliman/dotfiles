var g_CNTfun=0;
function groupclicked(d){if(d.which&&3==d.which)return!0;if(_this.locked)return d.preventDefault(),d.target.blur(),_this.error("LOCKED");"INS"==d.target.tagName&&d.target.nextSibling&&d.target.nextSibling.hasAttribute("isgroup")?d.target=d.target.nextSibling:"INS"==d.target.tagName&&d.target.parentNode&&d.target.parentNode.nextSibling&&d.target.parentNode.nextSibling.nextSibling&&d.target.parentNode.nextSibling.nextSibling.hasAttribute("isgroup")&&(d.target=d.target.parentNode.nextSibling.nextSibling);if(d.target.hasAttribute("isgroup")){_this.off_height();
if(d.pageY-$(d.target).offset().top>_this.li_height)return!0;_this.toggle_branch.apply(_this,[d.target])}else _this.select_branch.apply(_this,[d.target,d.ctrlKey||"on"==_this.settings.rules.multiple,d.shiftKey]);_this.inp&&_this.inp.blur();d.preventDefault();d.target.blur();return!1}var lastdblclick=new Date,g_tree=null;
(function(d){function c(){return{cntr:++c.cntr,settings:d.extend({},d.tree.defaults),init:function(a,b){g_tree=this;this.container=d(a);if(0==this.container.size)return!1;c.inst[this.cntr]=this;this.container.attr("id")||this.container.attr("id","jstree_"+this.cntr);c.inst[this.container.attr("id")]=c.inst[this.cntr];c.focused=this.cntr;this.settings=d.extend(!0,{},this.settings,b);if(this.settings.languages&&this.settings.languages.length){this.current_lang=this.settings.languages[0];for(var g,f=
"#"+this.container.attr("id"),e=0;e<this.settings.languages.length;e++)g=c.add_css(f+" ."+this.settings.languages[e]),!1!==g&&(g.style.display=this.settings.languages[e]==this.current_lang?"":"none")}else this.current_lang=!1;this.container.addClass("tree");!1!==this.settings.ui.theme_name&&(""!=this.settings.ui.theme_path&&-1==d.inArray(this.settings.ui.theme_path,c.themes)&&(c.add_sheet({url:this.settings.ui.theme_path}),c.themes.push(this.settings.ui.theme_path)),this.container.addClass("tree-"+
this.settings.ui.theme_name));g="";for(var h in this.settings.types)this.settings.types.hasOwnProperty(h)&&this.settings.types[h].icon&&(this.settings.types[h].icon.image||this.settings.types[h].icon.position)&&(g="default"==h?g+("#"+this.container.attr("id")+" li > a ins { "):g+("#"+this.container.attr("id")+" li[rel="+h+"] > a ins { "),this.settings.types[h].icon.image&&(g+=" background-image:url("+this.settings.types[h].icon.image+"); "),this.settings.types[h].icon.position&&(g+=" background-position:"+
this.settings.types[h].icon.position+"; "),g+="} ");""!=g&&c.add_sheet({str:g});this.settings.rules.multiple&&(this.selected_arr=[]);this.locked=this.hovered=this.offset=!1;!1===c.drag_drop.marker&&(c.drag_drop.marker=d("<div>").attr({id:"jstree-marker"}).hide().appendTo("body"));this.callback("oninit",[this]);this.refresh();this.attach_events();this.focus()},refresh:function(a){if(this.locked)return this.error("LOCKED");var b=this;a&&!this.settings.data.async&&(a=!1);this.is_partial_refresh=a?!0:
!1;this.opened=[];0!=this.settings.opened?(d.each(this.settings.opened,function(a,c){0<this.replace(/^#/,"").length&&b.opened.push("#"+this.replace(/^#/,""))}),this.settings.opened=!1):this.container.find("li.open").each(function(a){this.id&&b.opened.push("#"+this.id)});if(this.selected)this.settings.selected=[],a?d(a).find("li:has(a.clicked)").each(function(){this.id&&b.settings.selected.push("#"+this.id)}):this.selected_arr?d.each(this.selected_arr,function(){this.attr("id")&&b.settings.selected.push("#"+
this.attr("id"))}):this.selected.attr("id")&&this.settings.selected.push("#"+this.selected.attr("id"));else if(!1!==this.settings.selected){var g=[];"object"==(typeof this.settings.selected).toLowerCase()?d.each(this.settings.selected,function(){0<this.replace(/^#/,"").length&&g.push("#"+this.replace(/^#/,""))}):0<this.settings.selected.replace(/^#/,"").length&&g.push("#"+this.settings.selected.replace(/^#/,""));this.settings.selected=g}if(a&&this.settings.data.async)return this.opened=[],a=this.get_node(a),
a.find("li.open").each(function(a){b.opened.push("#"+this.id)}),a.hasClass("open")&&a.removeClass("open").addClass("closed"),a.hasClass("leaf")&&a.removeClass("leaf"),a.children("ul:eq(0)").html(""),this.open_branch(a,!0,function(){b.reselect.apply(b)});var b=this,c=new d.tree.datastores[this.settings.data.type];0==this.container.children("ul").size()&&this.container.html("<ul class='ltr directionltr'><li class='last'><a class='loading' href='#'><ins>&nbsp;</ins>"+(this.settings.lang.loading||"Loading ...")+
"</a></li></ul>");c.load(this.callback("beforedata",[!1,this]),this,this.settings.data.opts,function(a){a=b.callback("ondata",[a,b]);c.parse(a,b,b.settings.data.opts,function(a){a=b.callback("onparse",[a,b]);b.container.empty().append(d("<ul class='ltr'>").html(a));b.container.find("li:last-child").addClass("last").end().find("li:has(ul)").not(".open").addClass("closed");b.container.find("li").not(".open").not(".closed").addClass("leaf");b.reselect()})})},reselect:function(a){var b=this;a?this.cl_count--:
this.cl_count=0;if(this.opened&&this.opened.length){a=!1;for(var c=0;this.opened&&c<this.opened.length;c++)if(this.settings.data.async){var f=this.get_node(this.opened[c]);f.size()&&0<f.hasClass("closed")&&(a=!0,f=this.opened[c].toString().replace("/","\\/"),delete this.opened[c],this.open_branch(f,!0,function(){b.reselect.apply(b,[!0])}),this.cl_count++)}else this.open_branch(this.opened[c],!0);if(this.settings.data.async&&a||0<this.cl_count)return;delete this.opened}0<this.cl_count||(this.container.css("direction",
"ltr").children("ul:eq(0)").addClass("ltr"),0==this.settings.ui.dots&&this.container.children("ul:eq(0)").addClass("no_dots"),this.scrtop&&(this.container.scrollTop(b.scrtop),delete this.scrtop),!1!==this.settings.selected&&(d.each(this.settings.selected,function(a){b.is_partial_refresh?b.select_branch(d(b.settings.selected[a].toString().replace("/","\\/"),b.container),!1!==b.settings.rules.multiple):b.select_branch(d(b.settings.selected[a].toString().replace("/","\\/"),b.container),!1!==b.settings.rules.multiple&&
0<a)}),this.settings.selected=!1),this.callback("onload",[b]))},get:function(a,b,c){b||(b=this.settings.data.type);c||(c=this.settings.data.opts);return(new d.tree.datastores[b]).get(a,this,c)},attach_events:function(){var a=this;this.container.bind("mousedown.jstree",function(a){if(c.drag_drop.isdown)return c.drag_drop.move_type=!1,a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),!1}).bind("mouseup.jstree",function(b){setTimeout(function(){a.focus.apply(a)},5)}).bind("click.jstree",
function(a){return!0});d("li",this.container.get(0)).live("click",function(b){if("LI"!=b.target.tagName&&"A"!=b.target.tagName)return!0;a.off_height();if(b.pageY-d(b.target).offset().top>a.li_height)return!0;a.toggle_branch.apply(a,[b.target]);b.stopPropagation();return!1}).live("contextmenu",function(b){return a.locked?(b.target.blur(),a.error("LOCKED")):a.callback("onrgtclk",[a.get_node(b.target).get(0),a,b])}).live("mousedown",function(b){a.domousedown(b)});d("li > span",this.container.get(0)).live("click",
groupclicked);d("a",this.container.get(0)).live("click",groupclicked).live("dblclick",function(b){if(a.locked)return b.preventDefault(),b.stopPropagation(),b.target.blur(),a.error("LOCKED");a.callback("ondblclk",[a.get_node(b.target).get(0),a]);b.preventDefault();b.stopPropagation();b.target.blur()}).live("contextmenu",function(b){return a.locked?(b.target.blur(),a.error("LOCKED")):a.callback("onrgtclk",[a.get_node(b.target).get(0),a,b])}).live("mouseover",function(b){if(a.locked)return b.preventDefault(),
b.stopPropagation(),a.error("LOCKED");!1===a.hovered||"A"!=b.target.tagName&&"INS"!=b.target.tagName||(a.hovered.children("a").removeClass("hover"),a.hovered=!1);a.callback("onhover",[a.get_node(b.target).get(0),a])}).live("mousedown",function(b){a.domousedown(b)})},domousedown:function(a){for(var b=!1,g=a.target;g;){if("function"==typeof g.getAttribute&&"thetree"==g.getAttribute("id")){b=!0;break}g=g.parentNode}if(b){_this=g_tree;if("left"==_this.settings.rules.drag_button&&a.which&&1!=a.which||
"right"==_this.settings.rules.drag_button&&a.which&&3!=a.which)return!0;_this.focus.apply(_this);if(_this.locked)return _this.error("LOCKED");b=_this.get_node(a.target);if(0!=_this.settings.rules.multiple&&1<_this.selected_arr.length&&b.children("a:eq(0)").hasClass("clicked")){var f=0,e;for(e in _this.selected_arr)_this.selected_arr.hasOwnProperty(e)&&_this.check("draggable",_this.selected_arr[e])&&(_this.selected_arr[e].addClass("dragged"),c.drag_drop.origin_tree=_this,f++);0<f&&(_this.check("draggable",
b)?c.drag_drop.drag_node=b:c.drag_drop.drag_node=_this.container.find("li.dragged:eq(0)"),c.drag_drop.isdown=!0,"function"==typeof getDragHTML?c.drag_drop.drag_help=d(getDragHTML(null)):(c.drag_drop.drag_help=d("<div id='jstree-dragged' class='tree "+(""!=_this.settings.ui.theme_name?" tree-"+_this.settings.ui.theme_name:"")+"' />").append("<ul class='"+_this.container.children("ul:eq(0)").get(0).className+"' />"),f=c.drag_drop.drag_node.clone(),0<_this.settings.languages.length&&f.find("a").not("."+
_this.current_lang).hide(),c.drag_drop.drag_help.children("ul:eq(0)").append(f),c.drag_drop.drag_help.find("li:eq(0)").removeClass("last").addClass("last").children("a").html("<ins>&nbsp;</ins>Multiple selection").end().children("ul").remove()),c.drag_drop.dragged=_this.container.find("li.dragged"))}else _this.check("draggable",b)&&(0<_this.settings.languages.length&&f.find("a").not("."+_this.current_lang).hide(),c.drag_drop.drag_node=b,f=b.clone(),"function"==typeof getDragHTML?c.drag_drop.drag_help=
d(getDragHTML(f)):(c.drag_drop.drag_help=d("<div id='jstree-dragged' class='tree "+(""!=_this.settings.ui.theme_name?" tree-"+_this.settings.ui.theme_name:"")+"' />").append("<ul class='"+_this.container.children("ul:eq(0)").get(0).className+"' />"),c.drag_drop.drag_help.children("ul:eq(0)").append(getDragHTML(f)),c.drag_drop.drag_help.find("li:eq(0)").removeClass("last").addClass("last")),c.drag_drop.isdown=!0,c.drag_drop.foreign=!1,c.drag_drop.origin_tree=_this,b.addClass("dragged"),c.drag_drop.dragged=
_this.container.find("li.dragged"));c.drag_drop.init_x=a.pageX;c.drag_drop.init_y=a.pageY;b.blur();a.preventDefault();a.stopPropagation();return!1}},focus:function(){if(this.locked)return!1;c.focused!=this.cntr&&(c.focused=this.cntr,this.callback("onfocus",[this]))},off_height:function(){if(!1===this.offset){this.container.css({position:"relative"});this.offset=this.container.offset();var a;if(a=parseInt(d.curCSS(this.container.get(0),"paddingTop",!0),10))this.offset.top+=a;if(a=parseInt(d.curCSS(this.container.get(0),
"borderTopWidth",!0),10))this.offset.top+=a;this.container.css({position:""})}isSafariNative()&&!this.li_height?this.li_height=20:this.li_height||(a=this.container.find("ul li.closed, ul li.leaf").eq(0),this.li_height=a.height(),a.children("ul:eq(0)").size()&&(this.li_height-=a.children("ul:eq(0)").height()),this.li_height||(this.li_height=18))},scroll_check:function(a,b){var g=this,f=g.container,e=g.container.offset(),d=f.scrollTop(),k=f.scrollLeft(),m=f.get(0).scrollWidth>f.width()?40:20;20>b-e.top&&
f.scrollTop(Math.max(d-g.settings.ui.scroll_spd,0));f.height()-(b-e.top)<m&&f.scrollTop(d+g.settings.ui.scroll_spd);20>a-e.left&&f.scrollLeft(Math.max(k-g.settings.ui.scroll_spd,0));40>f.width()-(a-e.left)&&f.scrollLeft(k+g.settings.ui.scroll_spd);if(f.scrollLeft()!=k||f.scrollTop()!=d)c.drag_drop.move_type=!1,c.drag_drop.ref_node=!1,c.drag_drop.marker.hide();c.drag_drop.scroll_time=setTimeout(function(){g.scroll_check(a,b)},50)},scroll_into_view:function(a){a=a?this.get_node(a):this.selected;if(!a)return!1;
a=a.offset().top;var b=this.container.offset().top,c=b+this.container.height(),f=this.container.get(0).scrollWidth>this.container.width()?40:20;a+5<b&&this.container.scrollTop(this.container.scrollTop()-(b-a+5));a+f>c&&this.container.scrollTop(this.container.scrollTop()+(a+f-c))},get_node:function(a){return d(a).closest("li")},get_type:function(a){if(a=a?this.get_node(a):this.selected)return a.attr(this.settings.rules.type_attr)||"default"},set_type:function(a,b){(b=b?this.get_node(b):this.selected)&&
a&&b.attr(this.settings.rules.type_attr,a)},get_text:function(a,b){a=this.get_node(a);if(!a||0==a.size())return"";this.settings.languages&&this.settings.languages.length?(b=b?b:this.current_lang,a=a.children("a."+b)):a=a.children("a:visible");var c="";a.contents().each(function(){if(3==this.nodeType)return c=this.data,!1});return c},check:function(a,b){if(this.locked)return!1;var c=!1;if(-1===b)"undefined"!=typeof this.settings.rules[a]&&(c=this.settings.rules[a]);else{b=b?this.get_node(b):this.selected;
if(!b)return;var f=this.get_type(b);"undefined"!=typeof this.settings.types[f]&&"undefined"!=typeof this.settings.types[f][a]?c=this.settings.types[f][a]:"undefined"!=typeof this.settings.types["default"]&&"undefined"!=typeof this.settings.types["default"][a]&&(c=this.settings.types["default"][a])}"function"==typeof c&&(c=c.call(null,b,this));return c=this.callback("check",[a,b,c,this])},check_move:function(a,b,g){if(this.locked||d(b).closest("li.dragged").size())return!1;var f=a.parents(".tree:eq(0)").get(0),
e=b.parents(".tree:eq(0)").get(0);if(f&&f!=e&&(e=d.tree.reference(e.id).settings.rules.multitree,"none"==e||d.isArray(e)&&-1==d.inArray(f.id,e)))return!1;e="inside"!=g?this.parent(b):this.get_node(b);a=this.get_node(a);if(0==e)return!1;var f=this.settings.rules.use_max_depth?this.check("max_depth",e):-1,h=this.settings.rules.use_max_children?this.check("max_children",e):-1,k=this.check("valid_children",e),m="string"==typeof a?a:this.get_type(a);if("undefined"!=typeof k&&("none"==k||"object"==typeof k&&
-1==d.inArray(m,d.makeArray(k))))return!1;if(this.settings.rules.use_max_children&&"undefined"!=typeof h&&-1!=h){if(0==h)return!1;k=1;1==c.drag_drop.moving&&0==c.drag_drop.foreign&&(k=c.drag_drop.dragged.size(),k-=e.find("> ul > li.dragged").size());if(h<e.find("> ul > li").size()+k)return!1}if(this.settings.rules.use_max_depth){if("undefined"!=typeof f&&0===f)return this.error("MOVE: MAX-DEPTH REACHED");f=0<f?f:!1;h=0;for(k=e;-1!==k;)if(k=this.parent(k),h++,e=this.check("max_depth",k),0<=e&&(f=!1===
f?e-h:Math.min(f,e-h)),!1!==f&&0>=f)return this.error("MOVE: MAX-DEPTH REACHED");if(!1!==f&&0>=f)return this.error("MOVE: MAX-DEPTH REACHED");if(!1!==f&&(e=1,"string"!=typeof a))for(k=a;0<k.size();){if(0>f-e)return this.error("MOVE: MAX-DEPTH REACHED");k=k.children("ul").children("li");e++}}return 0==this.callback("check_move",[a,b,g,this])?!1:!0},hover_branch:function(a){if(this.locked)return this.error("LOCKED");a=this.get_node(a);if(!a.size())return this.error("HOVER: NOT A VALID NODE");if(!this.check("clickable",
a))return this.error("SELECT: NODE NOT SELECTABLE");this.hovered&&this.hovered.children("A").removeClass("hover");this.hovered=a;this.hovered.children("a").addClass("hover");this.scroll_into_view(this.hovered)},select_branch:function(a,b,c){if(this.locked)return this.error("LOCKED");a||!1===this.hovered||(a=this.hovered);var g=this;a=g.get_node(a);if(!a.size())return this.error("SELECT: NOT A VALID NODE");a.children("a").removeClass("hover");if(!g.check("clickable",a))return this.error("SELECT: NODE NOT SELECTABLE");
if(!1===g.callback("beforechange",[a.get(0),g]))return this.error("SELECT: STOPPED BY USER");if(0!=this.settings.rules.multiple&&b&&0<a.children("a.clicked").size())return this.deselect_branch(a);if(0!=this.settings.rules.multiple&&(b||c)){if(c&&0<this.selected_arr.length){var e=this.selected_arr[this.selected_arr.length-1],h=this.container.find("li.leaf"),k=a.position().top,e=e.position().top,m=k>e?k:e,l=k<e?k:e;h.each(function(){if(0<d(this).height()){var b=d(this).position().top;b<m&&b>l&&d(this).html()!=
a.html()&&(g.selected_arr.push(d(this)),d(this).addClass("clicked"),d(this).children("A").addClass("clicked"))}})}this.selected_arr.push(a)}if(0!=this.settings.rules.multiple&&!b&&!c){for(var n in this.selected_arr)this.selected_arr.hasOwnProperty(n)&&(this.selected_arr[n].children("A").removeClass("clicked"),this.selected_arr[n].removeClass("clicked"),this.callback("ondeselect",[this.selected_arr[n].get(0),g]));this.selected_arr=[];this.selected_arr.push(a);this.selected&&this.selected.children("A").hasClass("clicked")&&
(this.selected.children("A").removeClass("clicked"),this.selected.removeClass("clicked"),this.callback("ondeselect",[this.selected.get(0),g]))}!this.settings.rules.multiple&&this.selected&&(this.selected.children("A").removeClass("clicked"),this.selected.removeClass("clicked"),this.callback("ondeselect",[this.selected.get(0),g]));this.selected=a;!1!==this.hovered&&(this.hovered.children("A").removeClass("hover"),this.hovered=a);this.selected.children("a").addClass("clicked").end().parents("li.closed").each(function(){g.open_branch(this,
!0)});this.selected.addClass("clicked");this.scroll_into_view(this.selected);this.callback("onselect",[this.selected.get(0),g]);this.callback("onchange",[this.selected.get(0),g])},deselect_branch:function(a){if(this.locked)return this.error("LOCKED");var b=this;a=this.get_node(a);if(0==a.children("a.clicked").size())return this.error("DESELECT: NODE NOT SELECTED");a.children("a").removeClass("clicked");a.removeClass("clicked");this.callback("ondeselect",[a.get(0),b]);0!=this.settings.rules.multiple&&
1<this.selected_arr.length?(this.selected_arr=[],this.container.find("a.clicked").filter(":first-child").parent().each(function(){b.selected_arr.push(d(this))}),a.get(0)==this.selected.get(0)&&(this.selected=this.selected_arr[0])):(0!=this.settings.rules.multiple&&(this.selected_arr=[]),this.selected=!1);this.callback("onchange",[a.get(0),b])},toggle_branch:function(a){if(this.locked)return this.error("LOCKED");a=this.get_node(a);if(a.hasClass("closed"))return this.open_branch(a);if(a.hasClass("open"))return this.close_branch(a)},
open_branch:function(a,b,c){var g=this;if(this.locked)return this.error("LOCKED");a=this.get_node(a);if(!a.size())return this.error("OPEN: NO SUCH NODE");if(a.hasClass("leaf"))return this.error("OPEN: OPENING LEAF NODE");if(this.settings.data.async&&0==a.find("li").size()){if(!1===this.callback("beforeopen",[a.get(0),this]))return this.error("OPEN: STOPPED BY USER");a.children("ul:eq(0)").remove().end().append("<ul><li class='last'><a class='loading' href='#'><ins>&nbsp;</ins>"+(g.settings.lang.loading||
"Loading ...")+"</a></li></ul>");a.removeClass("closed").addClass("open");var e=new d.tree.datastores[this.settings.data.type];e.load(this.callback("beforedata",[a,this]),this,this.settings.data.opts,function(b){(b=g.callback("ondata",[b,g]))&&0!=b.length?e.parse(b,g,g.settings.data.opts,function(b){b=g.callback("onparse",[b,g]);a.children("ul:eq(0)").replaceWith(d("<ul>").html(b));a.find("li:last-child").addClass("last").end().find("li:has(ul)").not(".open").addClass("closed");a.find("li").not(".open").not(".closed").addClass("leaf");
g.open_branch.apply(g,[a]);c&&c.call()}):(a.removeClass("closed").removeClass("open").addClass("leaf").children("ul").remove(),c&&c.call())})}else{if(!this.settings.data.async&&!1===this.callback("beforeopen",[a.get(0),this]))return this.error("OPEN: STOPPED BY USER");0<parseInt(this.settings.ui.animation)&&!b?(a.children("ul:eq(0)").css("display","none"),a.removeClass("closed").addClass("open"),a.children("ul:eq(0)").slideDown(parseInt(this.settings.ui.animation),function(){d(this).css("display",
"");c&&c.call()})):(a.removeClass("closed").addClass("open"),c&&c.call());this.callback("onopen",[a.get(0),this])}return!0},close_branch:function(a,b){if(this.locked)return this.error("LOCKED");var c=this;a=this.get_node(a);if(!a.size())return this.error("CLOSE: NO SUCH NODE");if(!1===c.callback("beforeclose",[a.get(0),c]))return this.error("CLOSE: STOPPED BY USER");0<parseInt(this.settings.ui.animation)&&!b&&1==a.children("ul:eq(0)").size()?a.children("ul:eq(0)").slideUp(parseInt(this.settings.ui.animation),
function(){a.hasClass("open")&&a.removeClass("open").addClass("closed");d(this).css("display","")}):a.hasClass("open")&&a.removeClass("open").addClass("closed");this.selected&&!1!==this.settings.ui.selected_parent_close&&0<a.children("ul:eq(0)").find("a.clicked").size()&&(a.find("li:has(a.clicked)").each(function(){c.deselect_branch(this)}),"select_parent"==this.settings.ui.selected_parent_close&&0==a.children("a.clicked").size()&&this.select_branch(a,0!=this.settings.rules.multiple&&0<this.selected_arr.length));
this.callback("onclose",[a.get(0),this])},open_all:function(a,b){if(this.locked)return this.error("LOCKED");var c=this;a=a?this.get_node(a):this.container;var f=a.find("li.closed").size();b?this.cl_count--:this.cl_count=0;0<f?(this.cl_count+=f,a.find("li.closed").each(function(){var a=this;c.open_branch.apply(c,[this,!0,function(){c.open_all.apply(c,[a,!0])}])})):0==this.cl_count&&this.callback("onopen_all",[this])},close_all:function(a){if(this.locked)return this.error("LOCKED");var b=this;a=a?this.get_node(a):
this.container;a.find("li.open").each(function(){b.close_branch(this,!0)});this.callback("onclose_all",[this])},set_lang:function(a){if(!d.isArray(this.settings.languages)||0==this.settings.languages.length)return!1;if(this.locked)return this.error("LOCKED");d.inArray(a,this.settings.languages)||"undefined"==typeof this.settings.languages[a]||(a=this.settings.languages[a]);if("undefined"==typeof a)return!1;if(a==this.current_lang)return!0;var b,g="#"+this.container.attr("id");b=c.get_css(g+" ."+this.current_lang);
!1!==b&&(b.style.display="none");b=c.get_css(g+" ."+a);!1!==b&&(b.style.display="");this.current_lang=a;return!0},get_lang:function(){return d.isArray(this.settings.languages)&&0!=this.settings.languages.length?this.current_lang:!1},create:function(a,b,c){if(this.locked)return this.error("LOCKED");var g=!1;-1==b?(g=!0,b=this.container):b=b?this.get_node(b):this.selected;if(!(g||b&&b.size()))return this.error("CREATE: NO NODE SELECTED");var e=c,h=b;"before"==c&&(c=b.parent().children().index(b),b=
b.parents("li:eq(0)"));"after"==c&&(c=b.parent().children().index(b)+1,b=b.parents("li:eq(0)"));g||0!=b.size()||(g=!0,b=this.container);if(!g){if(!this.check("creatable",b))return this.error("CREATE: CANNOT CREATE IN NODE");if(b.hasClass("closed")){if(this.settings.data.async&&0==b.children("ul").size()){var k=this;return this.open_branch(b,!0,function(){k.create.apply(k,[a,b,c])})}this.open_branch(b,!0)}}var m=!1;a=a?d.extend(!0,{},a):{};a.attributes||(a.attributes={});a.attributes[this.settings.rules.type_attr]||
(a.attributes[this.settings.rules.type_attr]=this.get_type(h)||"default");if(this.settings.languages.length){a.data||(a.data={},m=!0);for(var l=0;l<this.settings.languages.length;l++)a.data[this.settings.languages[l]]||(a.data[this.settings.languages[l]]="string"!=(typeof this.settings.lang.new_node).toLowerCase()&&this.settings.lang.new_node[l]?this.settings.lang.new_node[l]:this.settings.lang.new_node)}else a.data||(a.data=this.settings.lang.new_node,m=!0);a=this.callback("ondata",[a,this]);h=d.tree.datastores.json().parse(a,
this);h=this.callback("onparse",[h,this]);h=d(h);h.children("ul").size()?h.is(".open")||h.addClass("closed"):h.addClass("leaf");h.find("li:last-child").addClass("last").end().find("li:has(ul)").not(".open").addClass("closed");h.find("li").not(".open").not(".closed").addClass("leaf");var n=this.settings.rules.use_max_depth?this.check("max_depth",g?-1:b):-1,p=this.settings.rules.use_max_children?this.check("max_children",g?-1:b):-1,l=this.check("valid_children",g?-1:b),q=this.get_type(h);if("undefined"!=
typeof l&&("none"==l||d.isArray(l)&&-1==d.inArray(q,l)))return this.error("CREATE: NODE NOT A VALID CHILD");if(this.settings.rules.use_max_children&&"undefined"!=typeof p&&-1!=p&&p>=this.children(b).size())return this.error("CREATE: MAX_CHILDREN REACHED");if(this.settings.rules.use_max_depth){if("undefined"!=typeof n&&0===n)return this.error("CREATE: MAX-DEPTH REACHED");n=0<n?n:!1;l=0;for(p=b;-1!==p&&!g;)if(p=this.parent(p),l++,q=this.check("max_depth",p),0<=q&&(n=!1===n?q-l:Math.min(n,q-l)),!1!==
n&&0>=n)return this.error("CREATE: MAX-DEPTH REACHED");if(!1!==n&&0>=n)return this.error("CREATE: MAX-DEPTH REACHED");if(!1!==n)for(l=1,p=h;0<p.size();){if(0>n-l)return this.error("CREATE: MAX-DEPTH REACHED");p=p.children("ul").children("li");l++}}if("undefined"==(typeof c).toLowerCase()||"inside"==c)c="top"==this.settings.rules.createat?0:b.children("ul:eq(0)").children("li").size();if(!1===(0==b.children("ul").size()||1==g&&0==b.children("ul").children("li").size()?g?this.moved(h,this.container.children("ul:eq(0)"),
"inside",!0):this.moved(h,b.children("a:eq(0)"),"inside",!0):"before"==e&&b.children("ul:eq(0)").children("li:nth-child("+(c+1)+")").size()?this.moved(h,b.children("ul:eq(0)").children("li:nth-child("+(c+1)+")").children("a:eq(0)"),"before",!0):"after"==e&&b.children("ul:eq(0)").children("li:nth-child("+c+")").size()?this.moved(h,b.children("ul:eq(0)").children("li:nth-child("+c+")").children("a:eq(0)"),"after",!0):b.children("ul:eq(0)").children("li:nth-child("+(c+1)+")").size()?this.moved(h,b.children("ul:eq(0)").children("li:nth-child("+
(c+1)+")").children("a:eq(0)"),"before",!0):this.moved(h,b.children("ul:eq(0)").children("li:last").children("a:eq(0)"),"after",!0)))return this.error("CREATE: ABORTED");m&&(this.select_branch(h.children("a:eq(0)")),this.rename());return h},rename:function(a,b){if(this.locked)return this.error("LOCKED");a=a?this.get_node(a):this.selected;var c=this;if(!a||!a.size())return this.error("RENAME: NO NODE SELECTED");if(!this.check("renameable",a))return this.error("RENAME: NODE NOT RENAMABLE");if(!this.callback("beforerename",
[a.get(0),c.current_lang,c]))return this.error("RENAME: STOPPED BY USER");a.parents("li.closed").each(function(){c.open_branch(this)});a=this.current_lang?a.find("a."+this.current_lang):a.find("a:first");var f={};f[this.container.attr("id")]=this.get_rollback();var e=a.children("ins").clone();if("string"==(typeof b).toLowerCase())a.text(b).prepend(e),c.callback("onrename",[c.get_node(a).get(0),c,f]);else{var h="";a.contents().each(function(){if(3==this.nodeType)return h=this.data,!1});c.inp=d("<input type='text' autocomplete='off' />");
c.inp.val(h.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<")).bind("mousedown",function(a){a.stopPropagation()}).bind("mouseup",function(a){a.stopPropagation()}).bind("click",function(a){a.stopPropagation()}).bind("keyup",function(a){a=a.keyCode||a.which;27==a?(this.value=h,this.blur()):13==a&&this.blur()});c.inp.blur(function(b){""==this.value&&(this.value=h);a.text(this.value).prepend(e);a.get(0).style.display="";a.prevAll("span").remove();c.inp=!1;c.callback("onrename",[c.get_node(a).get(0),
c,f])});var k=d("<span />").addClass(a.attr("class")).append(e).append(c.inp);a.get(0).style.display="none";a.parent().prepend(k);c.inp.get(0).focus();c.inp.get(0).select()}},remove:function(a){if(this.locked)return this.error("LOCKED");var b=this,c={};c[this.container.attr("id")]=this.get_rollback();if(!a||this.selected&&this.get_node(a).get(0)==this.selected.get(0))if(this.selected){if(!this.check("deletable",this.selected))return this.error("DELETE: NODE NOT DELETABLE");if(!this.callback("beforedelete",
[this.selected.get(0),b]))return this.error("DELETE: STOPPED BY USER");$parent=this.selected.parent();a=this.selected;if(0==this.settings.rules.multiple||1==this.selected_arr.length)var f=!0,e="select_previous"==this.settings.ui.selected_delete?this.prev(this.selected):!1;a=a.remove();$parent.children("li:last").addClass("last");0==$parent.children("li").size()&&($li=$parent.parents("li:eq(0)"),$li.removeClass("open").removeClass("closed").addClass("leaf").children("ul").remove());f||0==this.settings.rules.multiple||
(b=this,this.selected_arr=[],this.container.find("a.clicked").filter(":first-child").parent().each(function(){b.selected_arr.push(d(this))}),0<this.selected_arr.length&&(this.selected=this.selected_arr[0],this.remove()));f&&e&&this.select_branch(e);this.callback("ondelete",[a.get(0),this,c])}else return this.error("DELETE: NO NODE SELECTED");else if(a=this.get_node(a),a.size()){if(!this.check("deletable",a))return this.error("DELETE: NODE NOT DELETABLE");if(!this.callback("beforedelete",[a.get(0),
b]))return this.error("DELETE: STOPPED BY USER");$parent=a.parent();if(a.find("a.clicked").size()){var h=!1;b.selected_arr=[];this.container.find("a.clicked").filter(":first-child").parent().each(function(){h||this!=b.selected.get(0)||(h=!0);if(-1!=d(this).parents().index(a))return!0;b.selected_arr.push(d(this))});h&&(this.selected=this.selected_arr[0]||!1)}a=a.remove();$parent.children("li:last").addClass("last");0==$parent.children("li").size()&&($li=$parent.parents("li:eq(0)"),$li.removeClass("open").removeClass("closed").addClass("leaf").children("ul").remove());
this.callback("ondelete",[a.get(0),this,c])}},next:function(a,b){"function"==typeof this.get_node&&(a=this.get_node(a));return a.size()?b?0<a.nextAll("li").size()?a.nextAll("li:eq(0)"):!1:a.hasClass("open")?a.find("li:eq(0)"):0<a.nextAll("li").size()?a.nextAll("li:eq(0)"):a.parents("li").next("li").eq(0):!1},prev:function(a,b){"function"==typeof this.get_node&&(a=this.get_node(a));if(!a.size())return!1;if(b)return 0<a.prevAll("li").size()?a.prevAll("li:eq(0)"):!1;if(a.prev("li").size()){for(a=a.prev("li").eq(0);a.hasClass("open");)a=
a.children("ul:eq(0)").children("li:last");return a}return a.parents("li:eq(0)").size()?a.parents("li:eq(0)"):!1},parent:function(a){a=this.get_node(a);return a.size()?a.parents("li:eq(0)").size()?a.parents("li:eq(0)"):-1:!1},children:function(a){if(-1===a)return this.container.children("ul:eq(0)").children("li");a=this.get_node(a);return a.size()?a.children("ul:eq(0)").children("li"):!1},toggle_dots:function(){this.settings.ui.dots?(this.settings.ui.dots=!1,this.container.children("ul:eq(0)").addClass("no_dots")):
(this.settings.ui.dots=!0,this.container.children("ul:eq(0)").removeClass("no_dots"))},callback:function(a,b){var c,f=null,e;for(e in this.settings.plugins)if("object"==typeof d.tree.plugins[e]&&(c=d.tree.plugins[e],c.callbacks&&"function"==typeof c.callbacks[a]&&(f=c.callbacks[a].apply(this,b)),"undefined"!==typeof f&&null!==f))if("ondata"==a||"onparse"==a)b[0]=f;else return f;c=this.settings.callback[a];if("function"==typeof c)return c.apply(null,b)},get_rollback:function(){var a={};a.html=this.container.html();
a.selected=this.selected?this.selected.attr("id"):!1;return a},moved:function(a,b,g,f,e,h){a=d(a);var k=d(a).parents("ul:eq(0)"),m=d(b);m.is("ins")&&(m=m.parent());if(!h&&(h={},h[this.container.attr("id")]=this.get_rollback(),!f)){var l=1<a.size()?a.eq(0).parents(".tree:eq(0)"):a.parents(".tree:eq(0)");l.get(0)!=this.container.get(0)&&(l=c.inst[l.attr("id")],h[l.container.attr("id")]=l.get_rollback());delete l}if("inside"==g&&this.settings.data.async){var n=this;if(this.get_node(m).hasClass("closed"))return this.open_branch(this.get_node(m),
!0,function(){n.moved.apply(n,[a,b,g,f,e,h])});if(1==this.get_node(m).find("> ul > li > a.loading").size()){setTimeout(function(){n.moved.apply(n,[a,b,g,f,e])},200);return}}if(1<a.size())return n=this,l=this.moved(a.eq(0),b,g,!1,e,h),a.each(function(a){0!=a&&l&&(l=n.moved(this,l.children("a:eq(0)"),"after",!1,e,h))}),a;e?(_what=a.clone(),_what.each(function(a){this.id+="_copy";d(this).find("li").each(function(){this.id+="_copy"});d(this).removeClass("dragged").find("a.clicked").removeClass("clicked").end().find("li.dragged").removeClass("dragged");
d(this).removeClass("dragged").find("li.clicked").removeClass("clicked").end().find("li.dragged").removeClass("dragged")})):_what=a;if(f){if(!this.callback("beforecreate",[this.get_node(a).get(0),this.get_node(b).get(0),g,this]))return!1}else if(!this.callback("beforemove",[a,b,g,this]))return!1;if(!f&&(l=a.parents(".tree:eq(0)"),l.get(0)!=this.container.get(0))){l=c.inst[l.attr("id")];if(l.settings.languages.length){var p=[];if(0==this.settings.languages.length)p.push("."+l.current_lang);else for(var q in this.settings.languages)if(this.settings.languages.hasOwnProperty(q))for(var r in l.settings.languages)l.settings.languages.hasOwnProperty(r)&&
this.settings.languages[q]==l.settings.languages[r]&&p.push("."+this.settings.languages[q]);if(0==p.length)return this.error("MOVE: NO COMMON LANGUAGES");_what.find("a").not(p.join(",")).remove()}_what.find("a.clicked").removeClass("clicked");_what.find("li.clicked").removeClass("clicked")}a=_what;switch(g){case "before":m.parents("ul:eq(0)").children("li.last").removeClass("last");m.parent().before(a.removeClass("last"));m.parents("ul:eq(0)").children("li:last").addClass("last");break;case "after":m.parents("ul:eq(0)").children("li.last").removeClass("last");
m.parent().after(a.removeClass("last"));m.parents("ul:eq(0)").children("li:last").addClass("last");break;case "inside":m.parent().children("ul:first").size()?"top"==this.settings.rules.createat?(m.parent().children("ul:first").prepend(a.removeClass("last")).children("li:last").addClass("last"),p=m.parent().children("ul:first").children("li:first"),p.size()&&(g="before",b=p)):(p=m.parent().children("ul:first").children(".last"),p.size()&&(g="after",b=p),m.parent().children("ul:first").children(".last").removeClass("last").end().append(a.removeClass("last")).children("li:last").addClass("last")):
(a.addClass("last"),m.parent().removeClass("leaf").append("<ul/>"),m.parent().hasClass("open")||m.parent().addClass("closed"),m.parent().children("ul:first").prepend(a)),m.parent().hasClass("closed")&&this.open_branch(m)}0==k.find("li").size()?(k=k.parent(),k.removeClass("open").removeClass("closed").addClass("leaf"),k.is(".tree")||k.children("ul").remove(),k.parents("ul:eq(0)").children("li.last").removeClass("last").end().children("li:last").addClass("last")):(k.children("li.last").removeClass("last"),
k.children("li:last").addClass("last"));e?this.callback("oncopy",[this.get_node(a).get(0),this.get_node(b).get(0),g,this,h]):f?this.callback("oncreate",[this.get_node(a).get(0),m.is("ul")?-1:this.get_node(b).get(0),g,this,h]):this.callback("onmove",[this.get_node(a).get(0),this.get_node(b).get(0),g,this,h]);return a},error:function(a){this.callback("error",[a,this]);return!1},lock:function(a){(this.locked=a)?this.container.children("ul:eq(0)").addClass("locked"):this.container.children("ul:eq(0)").removeClass("locked")},
cut:function(a){if(this.locked)return this.error("LOCKED");a=a?this.get_node(a):this.container.find("a.clicked").filter(":first-child").parent();if(!a||!a.size())return this.error("CUT: NO NODE SELECTED");c.cut_copy.copy_nodes=!1;c.cut_copy.cut_nodes=a},copy:function(a){if(this.locked)return this.error("LOCKED");a=a?this.get_node(a):this.container.find("a.clicked").filter(":first-child").parent();if(!a||!a.size())return this.error("COPY: NO NODE SELECTED");c.cut_copy.copy_nodes=a;c.cut_copy.cut_nodes=
!1},paste:function(a,b){if(this.locked)return this.error("LOCKED");var g=!1;-1==a?(g=!0,a=this.container):a=a?this.get_node(a):this.selected;if(!(g||a&&a.size()))return this.error("PASTE: NO NODE SELECTED");if(!c.cut_copy.copy_nodes&&!c.cut_copy.cut_nodes)return this.error("PASTE: NOTHING TO DO");var f=b;if("before"==b)b=a.parent().children().index(a),a=a.parents("li:eq(0)");else if("after"==b)b=a.parent().children().index(a)+1,a=a.parents("li:eq(0)");else if("undefined"==(typeof b).toLowerCase()||
"inside"==b)b="top"==this.settings.rules.createat?0:a.children("ul:eq(0)").children("li").size();g||0!=a.size()||(g=!0,a=this.container);if(c.cut_copy.copy_nodes&&c.cut_copy.copy_nodes.size()){var e=!0;if(!g&&!this.check_move(c.cut_copy.copy_nodes,a.children("a:eq(0)"),"inside"))return!1;0==a.children("ul").size()||1==g&&0==a.children("ul").children("li").size()?g?this.moved(c.cut_copy.copy_nodes,this.container.children("ul:eq(0)"),"inside",!1,!0):this.moved(c.cut_copy.copy_nodes,a.children("a:eq(0)"),
"inside",!1,!0):"before"==f&&a.children("ul:eq(0)").children("li:nth-child("+(b+1)+")").size()?this.moved(c.cut_copy.copy_nodes,a.children("ul:eq(0)").children("li:nth-child("+(b+1)+")").children("a:eq(0)"),"before",!1,!0):"after"==f&&a.children("ul:eq(0)").children("li:nth-child("+b+")").size()?this.moved(c.cut_copy.copy_nodes,a.children("ul:eq(0)").children("li:nth-child("+b+")").children("a:eq(0)"),"after",!1,!0):a.children("ul:eq(0)").children("li:nth-child("+(b+1)+")").size()?this.moved(c.cut_copy.copy_nodes,
a.children("ul:eq(0)").children("li:nth-child("+(b+1)+")").children("a:eq(0)"),"before",!1,!0):this.moved(c.cut_copy.copy_nodes,a.children("ul:eq(0)").children("li:last").children("a:eq(0)"),"after",!1,!0);c.cut_copy.copy_nodes=!1}if(c.cut_copy.cut_nodes&&c.cut_copy.cut_nodes.size()){e=!0;a.parents().andSelf().each(function(){if(-1!=c.cut_copy.cut_nodes.index(this))return e=!1});if(!e)return this.error("Invalid paste");if(!g&&!this.check_move(c.cut_copy.cut_nodes,a.children("a:eq(0)"),"inside"))return!1;
0==a.children("ul").size()||1==g&&0==a.children("ul").children("li").size()?g?this.moved(c.cut_copy.cut_nodes,this.container.children("ul:eq(0)"),"inside"):this.moved(c.cut_copy.cut_nodes,a.children("a:eq(0)"),"inside"):"before"==f&&a.children("ul:eq(0)").children("li:nth-child("+(b+1)+")").size()?this.moved(c.cut_copy.cut_nodes,a.children("ul:eq(0)").children("li:nth-child("+(b+1)+")").children("a:eq(0)"),"before"):"after"==f&&a.children("ul:eq(0)").children("li:nth-child("+b+")").size()?this.moved(c.cut_copy.cut_nodes,
a.children("ul:eq(0)").children("li:nth-child("+b+")").children("a:eq(0)"),"after"):a.children("ul:eq(0)").children("li:nth-child("+(b+1)+")").size()?this.moved(c.cut_copy.cut_nodes,a.children("ul:eq(0)").children("li:nth-child("+(b+1)+")").children("a:eq(0)"),"before"):this.moved(c.cut_copy.cut_nodes,a.children("ul:eq(0)").children("li:last").children("a:eq(0)"),"after");c.cut_copy.cut_nodes=!1}},search:function(a,b){if(!a||this.srch&&a!=this.srch)this.srch="",this.srch_opn=!1,this.container.find("a.search").removeClass("search");
if(this.srch=a){b||(b="contains");a=a.toLowerCase();var c=null,f=search_string_tokenize(a);"undefined"!=g_all_li&&null!=g_all_li&&0<=f.length&&(g_CNTfun++,c=g_all_li.filter(function(){var a=search_it(this.id,f);this.style.display=a?"":"none";return a}),lp_display_folders(c,this),this.callback("onsearch",[c,this]))}},add_sheet:c.add_sheet,destroy:function(){this.callback("ondestroy",[this]);if("undefined"==typeof LPFromWebsite||"function"!=typeof LPFromWebsite.ipad)if(this.container.unbind(".jstree"),
d("#"+this.container.attr("id")).die("click.jstree").die("dblclick.jstree").die("mouseover.jstree").die("mouseout.jstree").die("mousedown.jstree"),this.container.removeClass("tree ui-widget ui-widget-content tree-default tree-"+this.settings.ui.theme_name).children("ul").removeClass("no_dots ltr locked").find("li").removeClass("leaf").removeClass("open").removeClass("closed").removeClass("last").children("a").removeClass("clicked hover search"),this.cntr==c.focused)for(var a in c.inst)if(a!=this.cntr&&
a!=this.container.attr("id")){c.inst[a].focus();break}c.inst[this.cntr]=!1;c.inst[this.container.attr("id")]=!1;delete c.inst[this.cntr];delete c.inst[this.container.attr("id")];c.cntr--}}}d.tree={datastores:{},plugins:{},defaults:{data:{async:!1,type:"html",opts:{method:"GET",url:!1}},selected:!1,opened:[],languages:[],ui:{dots:!0,animation:0,scroll_spd:7,theme_path:!1,theme_name:"default",selected_parent_close:"select_parent",selected_delete:"select_previous"},types:{"default":{clickable:!0,renameable:!0,
deletable:!0,creatable:!0,draggable:"undefined"==typeof LPFromWebsite||"function"!=typeof LPFromWebsite.ipad,max_children:-1,max_depth:-1,valid_children:"all",icon:{image:!1,position:!1}}},rules:{multiple:!1,multitree:"none",type_attr:"rel",createat:"bottom",drag_copy:"ctrl",drag_button:"left",use_max_children:!0,use_max_depth:!0,max_children:-1,max_depth:-1,valid_children:"all"},lang:{new_node:"New folder",loading:"Loading ..."},callback:{beforechange:function(a,b){return!0},beforeopen:function(a,
b){return!0},beforeclose:function(a,b){return!0},beforemove:function(a,b,c,f){return!0},beforecreate:function(a,b,c,f){return!0},beforerename:function(a,b,c){return!0},beforedelete:function(a,b){return!0},beforedata:function(a,b){return{id:d(a).attr("id")||0}},ondata:function(a,b){return a},onparse:function(a,b){return a},onhover:function(a,b){},onselect:function(a,b){},ondeselect:function(a,b){},onchange:function(a,b){},onrename:function(a,b,c){},onmove:function(a,b,c,f,e){},oncopy:function(a,b,
c,f,e){},oncreate:function(a,b,c,f,e){},ondelete:function(a,b,c){},onopen:function(a,b){"function"==typeof lponopen&&lponopen(a,b)},onopen_all:function(a){},onclose_all:function(a){},onclose:function(a,b){"function"==typeof lponclose&&lponclose(a,b)},error:function(a,b){},ondblclk:function(a,b){var c=lastdblclick;lastdblclick=new Date;c.getTime()>lastdblclick.getTime()-1E3||(b.toggle_branch.call(b,a),b.select_branch.call(b,a))},onrgtclk:function(a,b,c){},onload:function(a){},oninit:function(a){},
onfocus:function(a){},ondestroy:function(a){},onsearch:function(a,b){a.addClass("search")},ondrop:function(a,b,c,f){},check:function(a,b,c,f){return c},check_move:function(a,b,c,f){return!0}},plugins:{}},create:function(){return new c},focused:function(){return c.inst[c.focused]},reference:function(a){var b=d(a);b.size()||(b=d("#"+a));if(!b.size())return null;b=b.is(".tree")?b.attr("id"):b.parents(".tree:eq(0)").attr("id");return c.inst[b]||null},rollback:function(a){for(var b in a)if(a.hasOwnProperty(b)){var g=
c.inst[b],f=!g.locked;f&&g.lock(!0);g.inp=!1;g.container.html(a[b].html).find(".dragged").removeClass("dragged").end().find(".hover").removeClass("hover");a[b].selected&&(g.selected=d("#"+a[b].selected),g.selected_arr=[],g.container.find("a.clicked").each(function(){g.selected_arr.push(g.get_node(this))}));f&&g.lock(!1);delete f;delete g}},drop_mode:function(a){a=d.extend(a,{show:!1,type:"default",str:"Foreign node"});c.drag_drop.foreign=!0;c.drag_drop.isdown=!0;c.drag_drop.moving=!0;c.drag_drop.appended=
!1;c.drag_drop.f_type=a.type;c.drag_drop.f_data=a;a.show?(c.drag_drop.drag_help=d("<div id='jstree-dragged' class='tree tree-default'><ul><li class='last dragged foreign'><a href='#'><ins>&nbsp;</ins>"+a.str+"</a></li></ul></div>"),c.drag_drop.drag_node=c.drag_drop.drag_help.find("li:eq(0)")):(c.drag_drop.drag_help=!1,c.drag_drop.drag_node=!1);!1!==d.tree.drag_start&&d.tree.drag_start.call(null,!1)},drag_start:!1,drag:!1,drag_end:!1};d.fn.tree=function(a){return this.each(function(){var b=d.extend({},
a);c.inst&&c.inst[d(this).attr("id")]&&c.inst[d(this).attr("id")].destroy();!1!==b&&(new c).init(this,b)})};c.cntr=0;c.inst={};c.themes=[];c.drag_drop={isdown:!1,drag_node:!1,drag_help:!1,dragged:!1,init_x:!1,init_y:!1,moving:!1,origin_tree:!1,marker:!1,move_type:!1,ref_node:!1,appended:!1,foreign:!1,droppable:[],open_time:!1,scroll_time:!1};c.mouseup=function(a){var b=c.drag_drop;b.open_time&&clearTimeout(b.open_time);b.scroll_time&&clearTimeout(b.scroll_time);b.moving&&!1!==d.tree.drag_end&&d.tree.drag_end.call(null,
a,b);if(!1===b.foreign&&b.drag_node&&b.drag_node.size()){b.drag_help.remove();if(b.move_type){var g=c.inst[b.ref_node.parents(".tree:eq(0)").attr("id")];g&&g.moved(b.dragged,b.ref_node,b.move_type,!1,"on"==b.origin_tree.settings.rules.drag_copy||"ctrl"==b.origin_tree.settings.rules.drag_copy&&a.ctrlKey)}b.move_type=!1;b.ref_node=!1}!1!==b.foreign&&(b.drag_help&&b.drag_help.remove(),b.move_type&&(g=c.inst[b.ref_node.parents(".tree:eq(0)").attr("id")])&&g.callback("ondrop",[b.f_data,g.get_node(b.ref_node).get(0),
b.move_type,g]),b.foreign=!1,b.move_type=!1,b.ref_node=!1);c.drag_drop.marker&&c.drag_drop.marker.hide();b.dragged&&b.dragged.size()&&b.dragged.removeClass("dragged");b.dragged=!1;b.drag_help=!1;b.drag_node=!1;b.f_type=!1;b.f_data=!1;b.init_x=!1;b.init_y=!1;b.moving=!1;b.appended=!1;b.origin_tree=!1;if(b.isdown)return b.isdown=!1,a.preventDefault(),a.stopPropagation(),!1};c.mousemove=function(a){var b=c.drag_drop,g=!1;if(b.isdown){if(!b.moving&&5>Math.abs(b.init_x-a.pageX)&&5>Math.abs(b.init_y-a.pageY))return a.preventDefault(),
a.stopPropagation(),!1;b.moving||(g=c.drag_drop.moving=!0);b.open_time&&clearTimeout(b.open_time);!1!==b.drag_help&&(b.appended||(!1!==b.foreign&&(b.origin_tree=d.tree.focused()),d("body").append(b.drag_help),b.w=b.drag_help.width(),b.appended=!0),b.drag_help.css({left:a.pageX+5,top:a.pageY+15}));g&&!1!==d.tree.drag_start&&d.tree.drag_start.call(null,a,b);!1!==d.tree.drag&&d.tree.drag.call(null,a,b);if("DIV"==a.target.tagName&&"jstree-marker"==a.target.id)return!1;var f=d(a.target);f.is("ins")&&(f=
f.parent());g=f.is(".tree")?f:f.parents(".tree:eq(0)");if(0==g.size()||!c.inst[g.attr("id")])return b.scroll_time&&clearTimeout(b.scroll_time),!1!==b.drag_help&&b.drag_help.find("li:eq(0) ins").addClass("forbidden"),b.move_type=!1,b.ref_node=!1,c.drag_drop.marker.hide(),!1;var e=c.inst[g.attr("id")];e.off_height();b.scroll_time&&clearTimeout(b.scroll_time);b.scroll_time=setTimeout(function(){e.scroll_check(a.pageX,a.pageY)},50);var h=!1;g.scrollTop();if("A"==a.target.tagName||"INS"==a.target.tagName){if(f.is("#jstree-dragged"))return!1;
e.get_node(a.target).hasClass("closed")&&(b.open_time=setTimeout(function(){e.open_branch(f)},500));var k=f.offset(),m=k.left-1,l=a.pageY-k.top,n=[],n=l<e.li_height/3+1?["before","inside","after"]:l>2*e.li_height/3-1?["after","inside","before"]:l<e.li_height/2?["inside","before","after"]:["inside","after","before"],p=!1,q=0==b.foreign?b.origin_tree.container.find("li.dragged"):b.f_type;d.each(n,function(a,b){if(e.check_move(q,f,b))return h=b,p=!0,!1});if(p){switch(h){case "before":l=k.top-2;c.drag_drop.marker.attr("class",
"marker");break;case "after":l=k.top-2+e.li_height;c.drag_drop.marker.attr("class","marker");break;case "inside":m-=2,l=k.top-2+e.li_height/2,c.drag_drop.marker.attr("class","marker_plus")}b.move_type=h;b.ref_node=d(a.target);!1!==b.drag_help&&b.drag_help.find(".forbidden").removeClass("forbidden");c.drag_drop.marker.css({left:m,top:l}).show()}}if((f.is(".tree")||f.is("ul"))&&0==f.find("li:eq(0)").size())k=f.offset(),b.move_type="inside",b.ref_node=g.children("ul:eq(0)"),!1!==b.drag_help&&b.drag_help.find(".forbidden").removeClass("forbidden"),
c.drag_drop.marker.attr("class","marker_plus"),c.drag_drop.marker.css({left:k.left+10,top:k.top+15}).show();else if("A"!=a.target.tagName&&"INS"!=a.target.tagName||!p)!1!==b.drag_help&&b.drag_help.find("li:eq(0) ins").addClass("forbidden"),b.move_type=!1,b.ref_node=!1,c.drag_drop.marker.hide();a.preventDefault();a.stopPropagation();return!1}return!0};d(function(){d(document).bind("mousemove.jstree",c.mousemove);d(document).bind("mouseup.jstree",c.mouseup)});c.cut_copy={copy_nodes:!1,cut_nodes:!1};
c.css=!1;c.get_css=function(a,b){a=a.toLowerCase();var g=c.css.cssRules||c.css.rules,f=0;do{if(g.length&&f>g.length+5)break;if(g[f].selectorText&&g[f].selectorText.toLowerCase()==a)return 1==b?(c.css.removeRule&&document.styleSheets[i].removeRule(f),c.css.deleteRule&&document.styleSheets[i].deleteRule(f),!0):g[f]}while(g[++f]);return!1};c.add_css=function(a){if(c.get_css(a))return!1;c.css.insertRule?c.css.insertRule(a+" { }",0):c.css.addRule(a,null,0);return c.get_css(a)};c.remove_css=function(a){return c.get_css(a,
!0)};c.add_sheet=function(a){if(a.str){var b=document.createElement("style");b.setAttribute("type","text/css");b.styleSheet?(document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet.cssText=a.str):(b.appendChild(document.createTextNode(a.str)),document.getElementsByTagName("head")[0].appendChild(b));return b.sheet||b.styleSheet}if(a.url)if(document.createStyleSheet)try{document.createStyleSheet(a.url)}catch(g){}else return b=document.createElement("link"),b.rel="stylesheet",b.type="text/css",
b.media="all",b.href=a.url,document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet};d(function(){navigator.userAgent.toLowerCase().match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/);var a="";d.browser.msie&&(6==d.browser.version&&(a+='.tree li { height:18px; zoom:1; } .tree li li { overflow:visible; } .tree .ltr li.last { margin-top: expression( (this.previousSibling && /open/.test(this.previousSibling.className) ) ? "-2px" : "0"); } .marker { width:45px; background-position:-32px top; } .marker_plus { width:5px; background-position:right top; }'),
7==d.browser.version&&(a+='.tree li li { overflow:visible; } .tree .ltr li.last { margin-top: expression( (this.previousSibling && /open/.test(this.previousSibling.className) ) ? "-2px" : "0"); }'));d.browser.opera&&(a+='.tree > ul > li.last:after { content:"."; display: block; height:1px; clear:both; visibility:hidden; }');d.browser.mozilla&&0==d.browser.version.indexOf("1.8")&&(a+=".tree .ltr li a { display:inline; float:left; } .tree li ul { clear:both; }");""!=a&&(c.css=c.add_sheet({str:a}))})})(jQuery);
(function(d){d.extend(d.tree.datastores,{html:function(){return{get:function(c,a,b){return c&&d(c).size()?d("<div>").append(a.get_node(c).clone()).html():a.container.children("ul:eq(0)").html()},parse:function(c,a,b,g){g&&g.call(null,c);return c},load:function(c,a,b,g){b.url?d.ajax({type:b.method,url:b.url,data:c,dataType:"html",success:function(a,b){g.call(null,a)},error:function(b,c,d){g.call(null,!1);a.error(d+" "+c)}}):g.call(null,b["static"]||a.container.children("ul:eq(0)").html())}}},json:function(){return{get:function(c,
a,b){var g=this;c=c&&0!=d(c).size()?d(c):a.container.children("ul").children("li");b||(b={});b.outer_attrib||(b.outer_attrib=["id","rel","class"]);b.inner_attrib||(b.inner_attrib=[]);if(1<c.size()){var f=[];c.each(function(){f.push(g.get(this,a,b))});return f}if(0==c.size())return[];var e={attributes:{},data:{}};c.hasClass("open")&&(e.data.state="open");c.hasClass("closed")&&(e.data.state="closed");for(var h in b.outer_attrib)if(b.outer_attrib.hasOwnProperty(h)){var k="class"==b.outer_attrib[h]?c.attr(b.outer_attrib[h]).replace(/(^| )last( |$)/ig,
" ").replace(/(^| )(leaf|closed|open)( |$)/ig," "):c.attr(b.outer_attrib[h]);"undefined"!=typeof k&&0<k.toString().replace(" ","").length&&(e.attributes[b.outer_attrib[h]]=k);delete k}if(a.settings.languages.length)for(h in a.settings.languages){if(a.settings.languages.hasOwnProperty(h)){var m=c.children("a."+a.settings.languages[h]);if(b.force||b.inner_attrib.length||m.children("ins").get(0).style.backgroundImage.toString().length||m.children("ins").get(0).className.length){if(e.data[a.settings.languages[h]]=
{},e.data[a.settings.languages[h]].title=a.get_text(c,a.settings.languages[h]),m.children("ins").get(0).style.className.length&&(e.data[a.settings.languages[h]].icon=m.children("ins").get(0).style.className),m.children("ins").get(0).style.backgroundImage.length&&(e.data[a.settings.languages[h]].icon=m.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")),b.inner_attrib.length){e.data[a.settings.languages[h]].attributes={};for(var l in b.inner_attrib)b.inner_attrib.hasOwnProperty(l)&&
(k=m.attr(b.inner_attrib[l]),"undefined"!=typeof k&&0<k.toString().replace(" ","").length&&(e.data[a.settings.languages[h]].attributes[b.inner_attrib[l]]=k),delete k)}}else e.data[a.settings.languages[h]]=a.get_text(c,a.settings.languages[h])}}else if(m=c.children("a"),e.data.title=a.get_text(c),m.children("ins").size()&&m.children("ins").get(0).className.length&&(e.data.icon=m.children("ins").get(0).className),m.children("ins").size()&&m.children("ins").get(0).style.backgroundImage.length&&(e.data.icon=
m.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")),b.inner_attrib.length)for(l in e.data.attributes={},b.inner_attrib)b.inner_attrib.hasOwnProperty(l)&&(k=m.attr(b.inner_attrib[l]),"undefined"!=typeof k&&0<k.toString().replace(" ","").length&&(e.data.attributes[b.inner_attrib[l]]=k),delete k);0<c.children("ul").size()&&(e.children=[],c.children("ul").children("li").each(function(){e.children.push(g.get(this,a,b))}));return e},parse:function(c,a,b,g){if("[object Array]"===
Object.prototype.toString.apply(c)){for(var f="",e=0;e<c.length;e++)"function"!=typeof c[e]&&(f+=this.parse(c[e],a,b));g&&g.call(null,f);return f}if(!c||!c.data)return g&&g.call(null,!1),"";var f="<li ",d=!1;if(c.attributes)for(e in c.attributes)if(c.attributes.hasOwnProperty(e))if("class"==e){f+=" class='"+c.attributes[e]+" ";if("closed"==c.state||"open"==c.state)f+=" "+c.state+" ";f+="' ";d=!0}else f+=" "+e+"='"+c.attributes[e]+"' ";d||"closed"!=c.state&&"open"!=c.state||(f+=" class='"+c.state+
"' ");f+=">";if(a.settings.languages.length)for(e=0;e<a.settings.languages.length;e++){d={href:"",style:""};d["class"]=a.settings.languages[e];if(c.data[a.settings.languages[e]]&&"undefined"!=(typeof c.data[a.settings.languages[e]].attributes).toLowerCase())for(var k in c.data[a.settings.languages[e]].attributes)c.data[a.settings.languages[e]].attributes.hasOwnProperty(k)&&(d[k]="style"==k||"class"==k?d[k]+(" "+c.data[a.settings.languages[e]].attributes[k]):c.data[a.settings.languages[e]].attributes[k]);
f+="<a";for(k in d)!d.hasOwnProperty(k)||"style"==k&&""==d[k]||(f+=" "+k+'="'+d[k]+'" ');f+=">";f=c.data[a.settings.languages[e]]&&c.data[a.settings.languages[e]].icon?f+("<ins "+(-1==c.data[a.settings.languages[e]].icon.indexOf("/")?" class='"+c.data[a.settings.languages[e]].icon+"' ":" style='background-image:url(\""+c.data[a.settings.languages[e]].icon+"\");' ")+">&nbsp;</ins>"):f+"<ins>&nbsp;</ins>";f+=("undefined"!=(typeof c.data[a.settings.languages[e]].title).toLowerCase()?c.data[a.settings.languages[e]].title:
c.data[a.settings.languages[e]])+"</a>"}else{d={href:"",style:"","class":""};if("undefined"!=(typeof c.data.attributes).toLowerCase())for(e in c.data.attributes)c.data.attributes.hasOwnProperty(e)&&(d[e]="style"==e||"class"==e?d[e]+(" "+c.data.attributes[e]):c.data.attributes[e]);f+="<a";for(e in d)!d.hasOwnProperty(e)||"style"==e&&""==d[e]||(f+=" "+e+'="'+d[e]+'" ');f+=">";d=k=null;"object"==typeof c.data&&(e="icon","undefined"!=typeof c.data[e]&&(k=c.data[e]),e="title","undefined"!=typeof c.data[e]&&
(d=c.data[e]));f=(k?f+('<img src="'+k+'" />'):f+"<ins>&nbsp;</ins>")+((d?d:c.data)+"</a>")}if(c.children&&c.children.length){f+="<ul>";for(e=0;e<c.children.length;e++)f+=this.parse(c.children[e],a,b);f+="</ul>"}f+="</li>";g&&g.call(null,f);return f},load:function(c,a,b,g){b["static"]?(g.call(null,b["static"]),b["static"]=null):d.ajax({type:b.method,url:b.url,data:c,dataType:"json",success:function(a,b){g.call(null,a)},error:function(b,c,d){g.call(null,!1);a.error(d+" "+c)}})}}}})})(jQuery);
function lp_display_folders(d,c){d.parents("li").css("display","");d.parents("li.closed").each(function(){c.open_branch(this,!0)})};
