function get_SAED_username_password_fields(c,m){var e=[];if(!c)return e;var b,e=getBG(),f=null,g=null;if(!c.save_all||!c.fields||0===c.fields.length)return[getusernamefromacct(c),getpasswordfromacct(c)];var d=[[50,50],[-50,-50],[-5,25],[5,-25],[10,-10],[-5,10],[5,-10],[-30,-30],[7,7],[1,-10],[-20,-20],[-20,-20]],k=null,n=null,r=new RegExp(get_ff_translation("ff_username_regexp")),t=new RegExp(get_ff_translation("ff_password_regexp")),u=new RegExp(get_ff_translation("ff_email_regexp")),v=new RegExp(get_ff_translation("ff_captcha_regexp")),
w=new RegExp(get_ff_translation("ff_combineddummy_regexp")),x=new RegExp(get_ff_translation("ff_search_regexp"));b=[];var a,p=c.fields.length;for(a=0;a<p;a++)b[a]={USCORE:0,PSCORE:0};for(a=0;a<p;a++){var l=c.fields[a].type,q=c.fields[a].value,h=c.fields[a].name;if(null===q||""===q)sprintf("[%d] %s VALUE:EMPTY",a,c.fields[a].name),b[a].USCORE+=d[1][0],b[a].PSCORE+=d[1][1];r.exec(h)&&(sprintf("[%d] %s NAME:USERNAME",a,c.fields[a].name),b[a].USCORE+=d[4][0],b[a].PSCORE+=d[4][1]);t.exec(h)&&(sprintf("[%d] %s NAME:PASSWORD",
a,c.fields[a].name),b[a].USCORE+=d[5][0],b[a].PSCORE+=d[5][1]);u.exec(h)&&(sprintf("[%d] %s NAME:EMAIL",a,c.fields[a].name),b[a].USCORE+=d[6][0],b[a].PSCORE+=d[6][1]);if(v.exec(h)||w.exec(h)||x.exec(h))sprintf("[%d] %s NAME:IGNORE",a,c.fields[a].name),b[a].USCORE+=d[7][0],b[a].PSCORE+=d[7][1];"password"==l?(sprintf("[%d] %s TYPE:PW_TYPE",a,c.fields[a].name),null===g&&(b[a].PSCORE+=d[8][1],g=a),b[a].USCORE+=d[2][0],b[a].PSCORE+=d[2][1]):lp_in_array(l,["text","tel","email","url"])?(sprintf("[%d] %s TYPE:TEXT_TYPE",
a,c.fields[a].name),null===f&&(b[a].USCORE+=d[8][0],f=a),b[a].USCORE+=d[3][0],b[a].PSCORE+=d[3][1]):lp_in_array(l,["number"])?(sprintf("[%d] %s TYPE:HTML5TEXTISH",a,c.fields[a].name),b[a].USCORE+=d[9][0],b[a].PSCORE+=d[9][1]):lp_in_array(l,"date month color datetime search range time datetime-local week".split(" "))?(sprintf("[%d] %s TYPE:HTML5NONTEXTISH",a,c.fields[a].name),b[a].USCORE+=d[10][0],b[a].PSCORE+=d[10][1]):lp_in_array(l,["reset","button","image","file","submit"])&&(sprintf("[%d] %s TYPE:HTML4NONTEXTISH",
a,c.fields[a].name),b[a].USCORE+=d[11][0],b[a].PSCORE+=d[11][1]);"j_username"===h?k=a:"j_password"===h&&"password"==l&&(n=a)}null!==k&&null!==n&&(b[k].USCORE+=d[0][0],b[n].PSCORE+=d[0][1]);f=0;d=-Infinity;g=0;k=-Infinity;for(a=0;a<p;a++)sprintf("FIELD %d name=%s U=%d/P=%d",a,c.fields[a].name,b[a].USCORE,b[a].PSCORE),b[a].USCORE>d&&(d=b[a].USCORE,f=a),b[a].PSCORE>k&&(k=b[a].PSCORE,g=a);b=[];a=is_encrypted_field(c.fields[f].type)?e.lpmdec_acct(c.fields[f].value,!0,c,e.g_shares):c.fields[f].value;null===
a&&(a="");sprintf("username: guessed %s/%s",c.fields[f].name,a);b.push(a);a=is_encrypted_field(c.fields[g].type)?e.lpmdec_acct(c.fields[g].value,!0,c,e.g_shares):c.fields[g].value;null===a&&(a="");sprintf("password: guessed %s/%s",c.fields[g].name,g_show_pw_in_logs?a:"<REDACTED>");b.push(a);return b}function value_is_masked(c,m){if(!c||"string"!=typeof c)return!1;var e=encodeURIComponent(c);return 0<=c.indexOf("***")||0<=e.indexOf("%E2%80%A2%E2%80%A2%E2%80%A2")}
function formdata_has_masked_values(c){if(!c)return!1;c="undefined"!=typeof c?c.split("\n"):[];for(var m=0;m<c.length;m++){var e=c[m].split("\t");if(4==e.length||5==e.length){decodeURIComponent(e[1]);var b=decodeURIComponent(e[2]),e=decodeURIComponent(e[4]);if(value_is_masked(b)&&"notseen"!=e)return console_warn("detected masked field value: "+b),!0}}return!1};
