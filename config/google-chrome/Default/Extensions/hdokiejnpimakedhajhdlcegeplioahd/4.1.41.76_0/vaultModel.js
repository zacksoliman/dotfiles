User=function(g,e,c){this._username=g;this._accountClass=e;this._userMenuText=this._element=null;this._identities=c;this._identityDropdown=null;(function(a){a.identityEnableCallback=function(b){a._identityDropdown&&a._identityDropdown.setValue(b._data.deciname,!1);a._userMenuText.children().detach();if(b instanceof AllIdentity)a._userMenuText.append(a._userInfo);else{var c=LPTools.createElement("ul","userMenuText");c.appendChild(LPTools.createElement("li","userMenuTextSingle truncateShort",b.getName()));
a._userMenuText.append(c)}};a.identityAddedCallback=function(b){a._identities.push(b);a._identityDropdown?a._identityDropdown.setIdentities(a._identities):a.initializeIdentityDropdown(a._element.get(0).firstChild)};Topics.get(Topics.IDENTITY_ENABLE).subscribe(a.identityEnableCallback);Topics.get(Topics.IDENTITY_ADDED).subscribe(a.identityAddedCallback)})(this)};
(function(g){User.prototype.destruct=function(){this._element.unbind();this._element.empty();this._userMenuText.empty();Topics.get(Topics.IDENTITY_ENABLE).unsubscribe(this.identityEnableCallback);Topics.get(Topics.IDENTITY_ADDED).unsubscribe(this.identityAddedCallback);this._identityDropdown=this._identities=this._userMenuText=this._element=this._accountClass=this._username=null};var e=function(c,a,b,d,f){f=f||{};f.id=b;f["class"]="menuListItem";b=LPTools.createElement("li");a=LPTools.createElement(a,
f);a.textContent=d;b.appendChild(a);c.appendChild(b);return b};User.prototype.initializeIdentityDropdown=function(c){var a=LPTools.createElement("li","menuListHeader identityDropdownMenuItem");a.appendChild(LPTools.createElement("div",{id:"identityDropdownContainer"}));a.children[0].appendChild(LPTools.createElement("img",{id:"identityDropdownIcon",src:"images/vault_4.0/Identity_Avatar.png"}));var b=LPTools.createElement("div");a.children[0].appendChild(b);var d=LPTools.createElement("input",{id:"identityDropdown",
"class":"dialogInput selectDropdown",type:"text"});b.appendChild(d);c.insertBefore(a,c.firstChild);this._identityDropdown=new IdentityDropdown(d,this._identities);c=0;for(b=this._identities.length;c<b;++c)d=this._identities[c],d._enabled&&this._identityDropdown.setValue(d.getName(),!1);LPPlatform.addEventListener(a,"click",function(a){a.stopPropagation()});$(a.nextElementSibling).addClass("divider")};User.prototype.initialize=function(c,a){var b=LPTools.createElement("ul");this._userInfo=LPTools.createElement("ul",
"userMenuText");this._userInfo.appendChild(LPTools.createElement("li","userMenuTextPrimary truncateShort",this._username));this._userInfo.appendChild(LPTools.createElement("li","userMenuTextSecondary",Strings.translateString(this._accountClass)));a.append(this._userInfo);$(e(b,"div","vaultToggleIcon",Strings.Vault.VAULT_TOGGLE)).bind("click",function(){bg.VaultToggle.toggleVault3_0()});$(e(b,"div","accountSettingsIcon",Strings.Vault.ACCOUNT_SETTINGS)).bind("click",function(){Topics.get(Topics.EDIT_SETTINGS).publish()});
$(e(b,"a","helpCenterIcon",Strings.Vault.HELP_CENTER,{href:"https://lastpass.com/support_helpcenter.php",target:"_blank"})).bind("click",function(){window.open("https://lastpass.com/support_helpcenter.php")});$(e(b,"div","logoutIcon",Strings.Vault.LOGOUT)).bind("click",LPProxy.logout);c.append(b);1<this._identities.length&&this.initializeIdentityDropdown(b);this._element=c;this._userMenuText=a};User.prototype.isFree=function(){return this._accountClass===Constants.USER_FREE}})(document);
