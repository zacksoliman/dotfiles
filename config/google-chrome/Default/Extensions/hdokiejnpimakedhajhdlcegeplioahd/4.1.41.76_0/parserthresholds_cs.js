var MAX_INPUTS_HARD=200,MAX_INPUTS_SOFT=100;function LP_exceedInputsThreshold(c){if(!c)return!0;var g=MAX_INPUTS_HARD,h=MAX_INPUTS_SOFT;c=c.getElementsByTagName("input");var b=c.length;if(b>g)return verbose_log("EIT: hard threshold exceed"),!0;if(b<h)return!1;var g=0,a;for(a=0;a<b;a++)if(c[a]){var d=c[a].type;"text"!=d&&"passwd"!=d||g++}return g>h?(verbose_log("EIT: soft threshold exceed"),!0):!1}var MAX_FORMS_HARD=20,MAX_FORMS_SOFT=10;
function LP_getFormsThreshold(c){function g(b,a){return b&&a&&!a.disabled?!0:!1}function h(a){if(!a||"undefined"==typeof a.elements||5<=a.elements.length)return!1;for(var b=0;b<a.elements.length&&5>b;b++)if("hidden"!=a.elements[b].type)return!1;return!0}if(!c)return 0;var b=MAX_FORMS_HARD,a=MAX_FORMS_SOFT,d=formcacheget(c,"fakedoc","max-forms-threshold");if(null!=d)return d;var d=c.getElementsByTagName("form"),e=d.length;Checkpoint.assert(e<b,"page has too many forms");if(e>b)h(d[0])&&h(d[1])&&h(d[b-
1])&&(b*=2);else if(e<a)return formcacheset(c,"fakedoc","max-forms-threshold",a),a;var k=0,l=new RegExp(lpgs("ff_loginform_regexp"),"i"),f;for(f=0;f<e&&f<b;f++)if(d[f]){g(c,d[f])&&k++;if(f>a&&g(c,d[f])){var m=d[f].id;if(l.exec(d[f].name)||l.exec(m))return formcacheset(c,"fakedoc","max-forms-threshold",b),b}if(f>b)break}if(k>a)return formcacheset(c,"fakedoc","max-forms-threshold",a+2),a+2;formcacheset(c,"fakedoc","max-forms-threshold",a);return a}
var MAX_FORM_ELEMENTS_HARD=500,MAX_FORM_ELEMENTS_SOFT=100;function LP_exceedFormElementsThreshold(c,g){if(!c||!g)return!0;var h=MAX_FORM_ELEMENTS_SOFT,b=g.elements,a=b.length;if(a>MAX_FORM_ELEMENTS_HARD)return verbose_log("EFET: hard threshold exceed"),!0;if(a<h)return!1;var d=0,e;for(e=0;e<a;e++)if(b[e]&&b[e]&&!b[e].disabled&&"FIELDSET"!=b[e].tagName&&"input"==b[e].tagName){var k=inputs[e].type;"text"!=k&&"passwd"!=k||d++}return d>h?(verbose_log("EFET: soft threshold exceed"),!0):!1};
